<% if post && post.post_type.name == 'Question' %>
  <% suggested_answers = @children.filter { |answer| answer.score > 0.5 } %>
  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
        "@type": "QAPage",
        "mainEntity": {
        "@type": "Question",
        "name": "<%= @post.title %>",
        "text": "<%= @post.body.gsub(/\r?\n/, '') %>",
        "answerCount": <%= @children&.length || 0 %>,
        "upvoteCount": <%= @post.upvote_count %>,
        "suggestedAnswer": [
        <% suggested_answers.each_with_index do |answer, i| %>
          <% if i > 0 then %>,<% end %>
          {
          "@type": "Answer",
          "text": "<%= answer.body.gsub(/\r?\n/, '') %>",
          "upvoteCount": <%= answer.upvote_count %>,
          "url": "<%= post_url(answer) %>"
          }
        <% end %>
        ]
      }
    }
  </script>
<% end %>